# ğŸ™ï¸ Tacotron 2: ê³ í’ˆì§ˆ End-to-End ìŒì„± í•©ì„± (2018)

---

## ğŸ“Œ ê°œìš”

**Tacotron 2**ëŠ” Googleì´ ë°œí‘œí•œ **2ë‹¨ê³„ End-to-End TTS ì‹œìŠ¤í…œ**ì…ë‹ˆë‹¤.  
í…ìŠ¤íŠ¸ë¥¼ **Mel-Spectrogram**ìœ¼ë¡œ ì˜ˆì¸¡í•œ ë’¤, **WaveNet vocoder**ë¡œ waveformì„ ìƒì„±í•©ë‹ˆë‹¤.

> âœ… Tacotron 1ë³´ë‹¤ ìŒì§ˆì´ **ë¹„ì•½ì ìœ¼ë¡œ í–¥ìƒ**ëœ ëª¨ë¸ì…ë‹ˆë‹¤.

---

## ğŸ§¬ ì „ì²´ êµ¬ì¡°

```text
í…ìŠ¤íŠ¸
 â†“
Text Embedding
 â†“
Encoder (CNN + BiLSTM)
 â†“
Attention (Location-sensitive)
 â†“
Decoder (Autoregressive LSTM)
 â†“
Mel-Spectrogram (80 Ã— T)
 â†“
Postnet (CNN)
 â†“
Vocoder (WaveNet / HiFi-GAN)
 â†“
Waveform (.wav)
```

---

## ğŸ“¦ êµ¬ì„± ìš”ì†Œë³„ ì„¤ëª…

### 1ï¸âƒ£ Text Embedding
- character or phoneme ì‹œí€€ìŠ¤ë¥¼ ê³ ì •ì°¨ì› ë²¡í„°ë¡œ ë³€í™˜  
- ì„ë² ë”© ì°¨ì› ë³´í†µ 512

---

### 2ï¸âƒ£ Encoder: CNN + BiLSTM

- Conv Layer: local context í•™ìŠµ (3Ã—1 conv, padding ìœ ì§€)
- BiLSTM Layer: global context í•™ìŠµ (ì–‘ë°©í–¥ ì²˜ë¦¬)

```text
ì…ë ¥: "ì‚¬ë‘í•´" â†’ ['ã……', 'ã…', 'ã„¹', 'ã…', 'ã…‡', 'ã…', 'ã…']
â†’ ì„ë² ë”© (7, 512)
â†’ Encoder ì¶œë ¥ (7, 512)
```

---

### 3ï¸âƒ£ Attention (Location-Sensitive)

- Decoderê°€ í˜„ì¬ ì˜ˆì¸¡ ì‹œì ì—ì„œ ì…ë ¥ì˜ ì–´ëŠ ìœ„ì¹˜ë¥¼ ë³¼ì§€ softí•˜ê²Œ ì„ íƒ  
- ì—°ì†ì ì´ê³  ì•ˆì •ì ì¸ alignment ì œê³µ (ê¸€ì-í”„ë ˆì„ ë§¤í•‘)

---

### 4ï¸âƒ£ Decoder: Autoregressive LSTM

- ì´ì „ mel frameì„ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ ë‹¤ìŒ frameì„ ì˜ˆì¸¡
- í•˜ë‚˜ì˜ stepë§ˆë‹¤ **r=1~5** frameì”© ìƒì„±
- dropout, teacher forcing ì ìš©

```text
ì…ë ¥: [<GO>], ì´ì „ mel
ì¶œë ¥: mel frame (80 dim)
```

---

### 5ï¸âƒ£ Postnet

- 5-layer 1D CNNìœ¼ë¡œ mel ì˜ˆì¸¡ê°’ ë³´ì •  
- ì „ì²´ mel ì˜ˆì¸¡ê°’ì— residual ì¶”ê°€

---

### 6ï¸âƒ£ Vocoder: WaveNet or HiFi-GAN

- ì˜ˆì¸¡ëœ mel-spectrogramì„ ì‹¤ì œ waveformìœ¼ë¡œ ë³€í™˜  
- Tacotron 2ëŠ” **WaveNet**ì„ ì‚¬ìš©í–ˆì§€ë§Œ, í˜„ì¬ëŠ” **HiFi-GAN, UnivNet**ì´ ë” ë¹ ë¥´ê³  ì •í™•

---

## âš™ï¸ ì‹¤ì œ ì˜ˆì‹œ: "ì‚¬ë‘í•´" í•©ì„±

### ğŸ§¾ ì…ë ¥ í…ìŠ¤íŠ¸

```text
ë¬¸ì¥: "ì‚¬ë‘í•´"
ìŒì†Œ ì‹œí€€ìŠ¤: ['ã……', 'ã…', 'ã„¹', 'ã…', 'ã…‡', 'ã…', 'ã…']
```

### â¡ï¸ ì²˜ë¦¬ íë¦„

```text
1. Embedding: [7, 512]  (ìŒì†Œ 7ê°œ, 512ì°¨ì›)
2. Encoder (CNN + BiLSTM): [7, 512]
3. Attention Context: [1, 512]  (Decoderê°€ í˜„ì¬ ì°¸ì¡°í•˜ëŠ” ì…ë ¥ ì •ë³´)
4. Decoder (LSTM): [1, 80]  (mel frame 1ê°œ ìƒì„±)
5. ë°˜ë³µì ìœ¼ë¡œ mel frame ìƒì„± â†’ mel-spectrogram (ì˜ˆ: [80, 120])
6. Postnet: ë³´ì • mel â†’ [80, 120]
7. Vocoder: HiFi-GAN(mel) â†’ waveform (.wav)
```

---

### ğŸ“ˆ ì‹œê°í™” (Mel ì˜ˆì¸¡ ê²°ê³¼)

```python
import matplotlib.pyplot as plt
import librosa.display

plt.figure(figsize=(10, 4))
librosa.display.specshow(mel_output, sr=22050, hop_length=256, x_axis='time', y_axis='mel')
plt.colorbar()
plt.title("Tacotron 2: Mel-spectrogram for 'ì‚¬ë‘í•´'")
plt.tight_layout()
plt.show()
```

---

## ğŸ” í•µì‹¬ íŠ¹ì§• ìš”ì•½

| í•­ëª©          | Tacotron 1                            | Tacotron 2                             |
|---------------|----------------------------------------|-----------------------------------------|
| Encoder       | CBHG (Conv Bank + GRU)                | CNN + BiLSTM                            |
| Decoder       | Autoregressive LSTM                   | ë™ì¼ (ë” ì•ˆì •ì ì¸ attention)           |
| Postnet       | ì—†ìŒ                                  | 5-layer CNN ë³´ì •                        |
| Vocoder       | Griffin-Lim (ë‚®ì€ ìŒì§ˆ)               | WaveNet (ê³ ìŒì§ˆ), ìš”ì¦˜ì€ HiFi-GAN ëŒ€ì²´ |
| ì¶œë ¥          | Mel + Linear Spectrogram              | Mel-Spectrogram only                    |

---

## ğŸ§  ì¥ì  & í•œê³„

### âœ… ì¥ì 
- ìŒì§ˆì´ ë§¤ìš° ë›°ì–´ë‚¨ (ìì—°ìŠ¤ëŸ¬ìš´ ëª©ì†Œë¦¬)
- attention + postnet ì¡°í•©ìœ¼ë¡œ ì •ë ¬/ë³´ì • ì•ˆì •í™”

### âš ï¸ í•œê³„
- Autoregressive â†’ ëŠë¦¼
- Long sentenceì—ì„œ attention collapse ë°œìƒ ê°€ëŠ¥
- ì‹¤ì‹œê°„ ì‘ìš© ì–´ë ¤ì›€ â†’ FastSpeechë¡œ ëŒ€ì²´ë¨

---

## ğŸ“š ë…¼ë¬¸ ì •ë³´

- Title: *Natural TTS synthesis by conditioning Wavenet on Mel spectrogram predictions*
- Link: [https://arxiv.org/abs/1712.05884](https://arxiv.org/abs/1712.05884)
- Code (Unofficial): [https://github.com/NVIDIA/tacotron2](https://github.com/NVIDIA/tacotron2)

---

## âœ… ìš”ì•½

| í•­ëª©      | ì„¤ëª…                                      |
|-----------|-------------------------------------------|
| ì…ë ¥      | í…ìŠ¤íŠ¸ (char ë˜ëŠ” phoneme)               |
| ì¶œë ¥      | Mel-spectrogram                          |
| êµ¬ì¡°      | Encoder (CNN+BiLSTM) â†’ Attention â†’ Decoder |
| ë³´ì •      | Postnet (CNN)                             |
| ìŒì„±í™”     | WaveNet ë˜ëŠ” HiFi-GANìœ¼ë¡œ waveform ìƒì„±    |

> Tacotron 2ëŠ” End-to-End TTSì˜ **ì‚¬ì‹¤ìƒ í‘œì¤€ êµ¬ì¡°**ë¡œ,  
> ì´í›„ FastSpeech, VITS ë“± ëª¨ë“  ëª¨ë¸ì˜ **ì¶œë°œì **ì…ë‹ˆë‹¤.
